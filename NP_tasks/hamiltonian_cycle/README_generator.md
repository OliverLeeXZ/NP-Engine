# 哈密顿回路（Hamiltonian Cycle）问题造题脚本使用说明

## 概述

这是一个基于规则的哈密顿回路问题（Hamiltonian Cycle Problem）造题脚本。其目标是生成一个无向图，并要求解答者找到图中的一个哈密顿回路——即一个访问图中每个顶点一次且仅一次，并最终返回起点的路径。

为了确保每个生成的问题都必然有解，此脚本采用了"植入解"的策略。具体步骤如下：
1.  **构建回路骨架**: 首先，脚本会确定所有顶点的数量 `n`。然后，它会创建一个包含从 `0` 到 `n-1` 所有顶点的路径，并将路径的终点和起点相连，形成一个覆盖所有顶点的基础回路。这个回路就是我们预先植入的"保证解"。
2.  **增加干扰边**: 在回路骨架的基础上，脚本会以一定的概率在图中随机增加额外的"干扰"边。这些边连接了原本在回路上不相邻的顶点，从而在图中制造出大量的"岔路"和非哈密顿回路，增加了寻找真实解的难度。

通过这种方法，我们生成的每个图都保证至少包含一个哈密顿回路。

## 使用方法

### 基本使用

默认情况下，脚本会生成5道中等难度的题目：

```bash
python generate_questions.py
```

### 指定参数

你可以通过命令行参数自定义生成的题目：

```bash
python generate_questions.py --num_questions 10 --difficulty hard --output my_hamiltonian_questions.json
```

## 超参数说明

### 预设难度

脚本的难度由两个核心内部参数共同决定：顶点的数量和干扰边的密度。

-   `--difficulty`: 设置难度级别。可选值：`easy`, `medium`, `hard` (默认: `medium`)。
    -   **easy**: 顶点数少 (10-15)，干扰边密度低 (20%)。回路相对容易发现。
    -   **medium**: 顶点数中等 (20-25)，干扰边密度中等 (30%)。
    -   **hard**: 顶点数多 (30-35)，干扰边密度高 (40%)。图变得更加稠密，使得在众多可能的路径中识别出完整的哈密顿回路变得非常困难。

### 核心参数

-   `--num_questions`: 生成的题目数量 (默认: 5)。
-   `--output`: 输出的JSON文件名 (默认: `generated_hamiltonian_cycle_questions.json`)。

*(注意：为了简化，此生成器暂未开放对内部参数（如顶点数、边密度）的直接命令行配置，但可以在脚本内部轻松扩展。)*

## 使用示例

### 1. 生成3道简单题目

```bash
python generate_questions.py --num_questions 3 --difficulty easy
```

### 2. 生成10道难题

```bash
python generate_questions.py --num_questions 10 --difficulty hard
```

## 输出文件

脚本会生成两个JSON文件：

1.  **题目文件** (例如, `generated_hamiltonian_cycle_questions.json`):
    -   只包含生成的图（以邻接表形式），采用紧凑的JSON格式。
    -   这是你应该提供给解答者的文件。

2.  **答案文件** (例如, `..._with_answers.json`):
    -   包含完整的题目、一个由"植入法"生成的保证解以及生成元数据。
    -   用于验证和评估。

### 紧凑的JSON输出格式示例

```json
{
  "big_small": "small",
  "questions": {
    "question1": {
      "0": [1, 3],
      "1": [0, 2],
      "2": [1, 3],
      "3": [0, 2]
    }
  }
}
```
*(注意: 在这个示例图中, `[0, 1, 2, 3, 0]` 是一个有效的哈密顿回路。)*

## 注意事项

-   **解的保证**: 脚本通过"植入解"确保每个问题至少有一个哈密顿回路。
-   **最优性**: 对于哈密顿回路问题，任何一个有效的解都是最优解（因为它访问了所有顶点）。因此，脚本提供的解是问题的一个有效最优解。
-   **随机性**: 每次运行脚本都会生成不同的问题（不同的回路路径和不同的干扰边）。

## 主要改进：

1. **灵活的难度组合**：
   - `--easy N`：生成N道简单题目（5-8个顶点，0.2边密度）
   - `--medium M`：生成M道中等题目（10-15个顶点，0.3边密度）
   - `--hard P`：生成P道困难题目（20-30个顶点，0.4边密度）

2. **两种输出模式**：
   - **混合模式**（默认）：所有题目合并到一个文件
   - **分离模式**（`--separate`）：每种难度生成单独文件

3. **智能题目命名**：
   - 混合模式：`easy_question1`, `medium_question1`, `hard_question1`
   - 分离模式：`question1`, `question2`, ...

## 使用示例：

```bash
# 生成5道简单、3道中等、2道困难题目（混合到一个文件）
python generate_questions.py --easy 5 --medium 3 --hard 2

# 生成10道简单题目和5道困难题目到单独文件
python generate_questions.py --easy 10 --hard 5 --separate

# 只生成8道中等题目
python generate_questions.py --medium 8

# 指定输出文件名
python generate_questions.py --easy 3 --medium 2 --hard 1 --output my_hamiltonian_dataset.json
```

## 输出信息增强：
脚本现在会显示详细统计：
- 每种难度的题目数量
- 总题目数
- 平均顶点数
- 生成的文件路径

## 难度级别说明：
- **简单（Easy）**：5-8个顶点，边密度0.2，容易找到哈密顿回路
- **中等（Medium）**：10-15个顶点，边密度0.3，需要一定搜索
- **困难（Hard）**：20-30个顶点，边密度0.4，图更复杂，搜索空间大

现在这个脚本与之前修改的图着色问题脚本保持了一致的接口和功能！ 